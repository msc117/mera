<!-- dependencies -->
<link rel="import" href="../bower_components/paper-material/paper-material.html">

<dom-module id="mera-tile">
	<style>
	:host {
		background-color: cyan;
	}
	:host:not(:last-child) {
		margin-right: 2em;
	}
	a {
		text-decoration: none;
		color: inherit;	
	}
	.tile {
		display: -webkit-flex;
		display: flex;
		display: -ms-flex;
		flex-direction: column;
		-webkit-flex-direction: column;
		-ms-flex-direction: column;
		height: 200px;
		width: 200px;
		overflow: hidden;
	}
	#tileHeroImage {
		position: absolute;
		top: 0;
		bottom: 0;
		right: 0;
		left: 0;
	}
	#tileHoverPopup {
		position: absolute;
		bottom: 0;
		background-color: white;		
		width: 100%;
		padding: 10px 16px;
		transition: all .32s ease-in-out;
		opacity: 0;
		visibility: hidden;
		box-sizing: border-box;
		transform: translate(0, 20px);
	}
	#tileHoverPopup.visible {
		visibility: visible;
		opacity: .7;
		transform: initial;
	}
	#tileHoverPopup > #tile-title {
		font-weight: bolder;
	}
	#editTarget {
		position: absolute;
		width: 50%;
		top: 0;
		right: 0;	
		height: 30%;
	}
	#tileEdit {
		transition: opacity .3s linear;
		color: rgba(0, 0, 0, 0.6);
		opacity: 0;
		top: 0;
		right: 0;
		position: absolute;	
	}
	#tileEdit.visible {
		opacity: 1;
	}
	/*
	#preview {
		width: 100%;
	    height: 100%;
	    border: none;
	    -moz-transform: scale(0.2);
	    -moz-transform-origin: 0 0;
	    -o-transform: scale(0.2);
	    -o-transform-origin: 0 0;
	    -webkit-transform: scale(0.2);
	    -webkit-transform-origin: 0 0;
	} */
	</style>
	<template>		
		<paper-material elevation="3">
			<a href="{{data.href}}" class="tile">
					<!-- <img id="p2i_demo" src="http://api.page2images.com/directlink?p2i_url={{data.href}}&p2i_device=6&p2i_screen=1024x768&p2i_size=200x200&p2i_key=f0ebb88b3500f6cf" /> -->			
				<div id="tileHeroImage" style="background-color: {{data.color}}"></div>
				<div id="editTarget">
					<paper-icon-button id="tileEdit" onclick="edit()" alt="edit" icon="menu"></paper-icon-button>
				</div>			
				<div id="tileHoverPopup">
					<div id="tile-title">{{data.title}}</div>
					<div id="tile-descr">{{data.descr}}</div>
				</div>
			</a>	
		</paper-material>		
	</template>
</dom-module>
<script>
(function() {
	Polymer({
		is: "mera-tile",

		listeners: {
			"mouseenter" : "tileHoverAction",
			"mouseleave" : "tileExitAction",
			"editTarget.mouseenter" : "showEdit",
			"editTarget.mouseleave" : "hideEdit"
		},

		properties: {
			data: {
				type: Object,
				reflectToAttribute: true
			}
		},

		ready: function() {
			console.log(this.data);
		},
		tileHoverAction: function() {
			this._showWithClass(this.$.tileHoverPopup, "visible");
		},
		tileExitAction: function() {
			this._hideByRemove(this.$.tileHoverPopup, "visible");
		},
		showEdit: function() {
			this._showWithClass(this.$.tileEdit, "visible");
		},
		hideEdit: function() {
			this._hideByRemove(this.$.tileEdit, "visible");
		},
		edit: function() {
			console.log(this);
		},

		// private functions
		_showWithClass: function(elem, className) {
			console.log("showing with: " + className);
			if (elem.className.indexOf(className) == -1)
				elem.className += " " + className;
		},
		_hideByRemove: function(elem, className) {
			console.log("removing: " + className);
			elem.classList.remove(className);
		}
	});
})();

</script>